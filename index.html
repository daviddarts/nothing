<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>NOTHING</title>

  <!-- Speed up Google Fonts + load Roboto -->
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;700;900&display=swap" rel="stylesheet" />

  <style>
    :root {
      /* base timings (ms) */
      --fade-in-ms: 2000;        /* slower fade-in (increase for softer entry) */
      --fade-out-ms: 800;        /* base fade-out */
      --hold-ms: 1200;
      --gap-ms: 200;

      /* first line tweaks */
      --first-hold-mult: 2;      /* first line visible 2x longer */
      --first-fade-in-mult: 1;   /* keep first-line fade-in same speed */
      --first-fade-out-mult: 2;  /* first line fades out slower */

      /* specials */
      --thanks-hold-ms: 3200;        /* linger on “Thanks for nothing.” */
      --link-hold-ms: 10000;         /* linked promo items ~10s */
      --nothing-extra-hold-ms: 1000; /* “nothing” stays 1s longer on fade-out */

      /* link styling (gray, no underline) */
      --link-color: #6b7280;     /* gray-500 */
      --link-hover: #111827;     /* gray-900 */
    }

    html, body {
      height: 100%;
      margin: 0;
      background: white;
      color: black;
    }

    body {
      display: flex;
      align-items: center;
      justify-content: center;
      -webkit-font-smoothing: antialiased;
      -moz-osx-font-smoothing: grayscale;
    }

    #line {
      font-family: "Roboto", "Helvetica Neue", Arial, sans-serif;
      font-weight: 900;
      font-size: clamp(28px, 8vw, 64px);
      line-height: 1.15;
      text-align: center;
      max-width: min(90vw, 1200px);
      opacity: 0;
      transition-property: opacity;
      /* gentler easing for both in/out; slow in is mostly from --fade-in-ms */
      transition-timing-function: cubic-bezier(0.2, 0, 0, 1);
      will-change: opacity;
    }

    /* Token spans so we can fade parts independently */
    .token { transition-property: opacity; }
    .rest  { opacity: 1; }
    .nothing { opacity: 1; }

    /* Links: gray, no underline, clear hover/focus */
    #line a {
      color: var(--link-color);
      text-decoration: none;
      cursor: pointer;
    }
    #line a:hover,
    #line a:focus-visible {
      color: var(--link-hover);
    }
    #line a:focus-visible {
      outline: 2px solid currentColor;
      outline-offset: 4px;
    }

    @media (prefers-reduced-motion: reduce) {
      #line, .token { transition: none; opacity: 1; }
    }
  </style>
</head>
<body>
  <div id="line" aria-live="polite"></div>

  <script>
    // Poem lines followed by three promo items:
    // 1) AiOP 2025 NOTHING (link, gray, ~10s)
    // 2) October 18-19 (no link, normal hold)
    // 3) DAVIDDARTS.COM (link, gray, ~10s)
    const items = [
      `Nothing to see here.`,
      `Less than nothing.`,
      `A whole lotta nothing.`,
      `A big fat nothingburger.`,
      `Nothing new under the sun.`,
      `Nothing but dead air.`,
      `Nothing but net.`,
      `This is nothing new.`,
      `Nothing special.`,
      `Nothing to write home about.`,
      `I’ve got nothing to do.`,
      `Nothing to wear.`,
      `Nothing fancy.`,
      `Nothing in particular.`,
      `Nothing much.`,
      `Practically nothing.`,
      `I won’t settle for nothing.`,
      `Something out of nothing?`,
      `Leave nothing to chance.`,
      `Nothing to lose.`,
      `Nothing to complain about.`,
      `Think nothing of it.`,
      `Next to nothing.`,
      `Close to nothing.`,
      `Better than nothing.`,
      `Nothing ventured, nothing gained.`,
      `Leave nothing on the table.`,
      `Accept nothing less.`,
      `There’s nothing to it.`,
      `Nothing compares.`,
      `Sweet nothings.`,
      `Leave nothing to the imagination.`,
      `Nothing short of a miracle.`,
      `Nothing to sneeze at.`,
      `Nothing else matters.`,
      `Nothing but the best.`,
      `Nothing can stop us.`,
      `Nothing can come between us.`,
      `Nothing but blue skies.`,
      `There’s nothing like it.`,
      `Nothing can go wrong.`,
      `All or nothing.`,
      `I will stop at nothing.`,
      `Double or nothing.`,
      `Nothing worth having comes easy.`,
      `Much ado about nothing.`,
      `Nothing of the sort.`,
      `Nothing to worry about.`,
      `Think nothing of it.`,
      `Nothing will come of it.`,
      `Make nothing of it.`,
      `It signifies nothing.`,
      `You have nothing to fear.`,
      `There’s nothing going on.`,
      `Have you nothing to say?`,
      `Nothing could be further from the truth.`,
      `I’ve got nothing to gain.`,
      `Nothing to add.`,
      `Nothing to prove.`,
      `Nothing to declare.`,
      `Nothing to hide.`,
      `Nothing to report.`,
      `I’ve done nothing to regret.`,
      `Time to say nothing.`,
      `Nothing but excuses.`,
      `You’ve got nothing on me.`,
      `Nothing but the truth.`,
      `Leave nothing out.`,
      `Nothing ever goes as planned.`,
      `Nothing good happens after 2AM.`,
      `Nothing but trouble.`,
      `Nothing short of a disaster.`,
      `There’s nothing between us.`,
      `Is nothing sacred?`,
      `Nothing but smoke and mirrors.`,
      `Nothing but empty promises.`,
      `This counts for nothing.`,
      `You can’t expect something for nothing.`,
      `Nothing is free.`,
      `Nothing lasts forever.`,
      `It’s nothing personal.`,
      `I’ve got nothing in the tank.`,
      `Nothing but skin and bones.`,
      `Nothing but the shirt on my back.`,
      `Nothing to show for it.`,
      `You are good for nothing.`,
      `This was all for nothing.`,
      `It all amounts to nothing.`,
      `It’s worth nothing.`,
      `I’ve got nothing.`,
      `You are nothing.`,
      `Thanks for nothing.`,
      // Promo sequence
      { text: 'AiOP 2025 NOTHING', href: 'https://nothing.artinoddplaces.org/' }, // link, ~10s
      { text: 'October 18-19' }, // normal hold
      { text: 'DAVIDDARTS.COM', href: 'https://daviddarts.com' }, // link, ~10s
    ];

    const el = document.getElementById('line');

    // Timings from CSS vars
    const css = getComputedStyle(document.documentElement);
    const fadeInBase  = parseInt(css.getPropertyValue('--fade-in-ms'))  || 2000;
    const fadeOutBase = parseInt(css.getPropertyValue('--fade-out-ms')) || 800;
    const holdBase    = parseInt(css.getPropertyValue('--hold-ms'))     || 1200;
    const gap         = parseInt(css.getPropertyValue('--gap-ms'))      || 200;

    const firstHoldMult     = parseFloat(css.getPropertyValue('--first-hold-mult'))     || 2;
    const firstFadeInMult   = parseFloat(css.getPropertyValue('--first-fade-in-mult'))  || 1;
    const firstFadeOutMult  = parseFloat(css.getPropertyValue('--first-fade-out-mult')) || 2;

    const thanksHold        = parseInt(css.getPropertyValue('--thanks-hold-ms'))        || (holdBase * 3);
    const linkHold          = parseInt(css.getPropertyValue('--link-hold-ms'))          || 10000;
    const nothingExtraHold  = parseInt(css.getPropertyValue('--nothing-extra-hold-ms')) || 1000;

    // Regex for tokenizing vs detection
    const NOTHING_SPLIT = /(nothing)s?/gi; // tokenize "nothing"/"nothings"
    const NOTHING_TEST  = /nothing/i;      // non-stateful detection

    const isObj = (item) => typeof item === 'object' && item !== null;
    const isLinkItem = (item) => isObj(item) && 'href' in item;

    function renderItemToHTML(item) {
      if (isLinkItem(item)) {
        return `<a href="${item.href}" target="_blank" rel="noopener noreferrer">${item.text}</a>`;
      }
      const text = isObj(item) ? item.text : String(item);
      const parts = text.split(NOTHING_SPLIT);
      let html = '';
      for (let idx = 0; idx < parts.length; idx++) {
        const part = parts[idx];
        if (!part) continue;
        if (/^nothing$/i.test(part)) {
          html += `<span class="token nothing">${part}</span>`;
        } else if (/^nothings$/i.test(part)) {
          html += `<span class="token nothing">nothing</span><span class="token rest">s</span>`;
        } else {
          html += `<span class="token rest">${part}</span>`;
        }
      }
      return html;
    }

    function lineHasNothing(item) {
      if (isLinkItem(item)) return false;
      const text = isObj(item) ? item.text : String(item);
      return NOTHING_TEST.test(text); // non-global, non-stateful
    }

    let i = 0;

    function cycle() {
      const item = items[i];
      const isFirst  = i === 0;
      const isThanks = (typeof item === 'string' && item === 'Thanks for nothing.');
      const isLink   = isLinkItem(item);
      const hasNothing = lineHasNothing(item);

      // Per-item durations
      const fadeInMs  = isFirst ? Math.round(fadeInBase  * firstFadeInMult)  : fadeInBase;
      const fadeOutMs = isFirst ? Math.round(fadeOutBase * firstFadeOutMult) : fadeOutBase;
      const holdMs    = isLink ? linkHold
                        : isThanks ? thanksHold
                        : isFirst  ? Math.round(holdBase * firstHoldMult)
                                   : holdBase;

      // Set content
      el.style.opacity = '0';
      el.style.transitionDuration = `${fadeInMs}ms`;
      el.innerHTML = renderItemToHTML(item);

      // Prepare token transitions for partial fade
      if (hasNothing) {
        el.querySelectorAll('.token').forEach(t => {
          t.style.transitionProperty = 'opacity';
          t.style.transitionTimingFunction = 'cubic-bezier(0.2, 0, 0, 1)';
          t.style.transitionDuration = `${fadeOutMs}ms`;
          t.style.opacity = '1';
        });
      }

      // Fade in container (slower now via --fade-in-ms)
      requestAnimationFrame(() => {
        el.style.opacity = '1';

        // After fade-in + hold, fade out
        setTimeout(() => {
          if (hasNothing) {
            // Fade the non-"nothing" parts first
            el.querySelectorAll('.rest').forEach(t => t.style.opacity = '0');

            // After extra hold, fade "nothing" itself
            setTimeout(() => {
              el.querySelectorAll('.nothing').forEach(t => t.style.opacity = '0');

              // After that fade finishes, advance
              setTimeout(() => {
                i = (i + 1) % items.length;
                cycle();
              }, fadeOutMs + gap);
            }, nothingExtraHold);
          } else {
            // Normal fade of whole container
            el.style.transitionDuration = `${fadeOutMs}ms`;
            el.style.opacity = '0';
            setTimeout(() => {
              i = (i + 1) % items.length;
              cycle();
            }, fadeOutMs + gap);
          }
        }, fadeInMs + holdMs);
      });
    }

    // Reduced motion
    const prefersReduced = window.matchMedia('(prefers-reduced-motion: reduce)').matches;
    if (prefersReduced) {
      const first = items[0];
      el.textContent = typeof first === 'string' ? first : first.text;
      el.style.opacity = '1';
    } else {
      cycle();
    }

    // Favicon: white box with black outline, injected with cache-busting
    (function setFavicon() {
      const svg =
        `<svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 64 64">
           <rect x="8" y="8" width="48" height="48" fill="#fff" stroke="#000" stroke-width="4" rx="6" ry="6"/>
         </svg>`;
      const href = "data:image/svg+xml," + encodeURIComponent(svg) + "#v=" + Date.now();
      document.querySelectorAll('link[rel="icon"]').forEach(n => n.remove());
      const link = document.createElement('link');
      link.rel = 'icon';
      link.type = 'image/svg+xml';
      link.href = href;
      document.head.appendChild(link);
    })();
  </script>
</body>
</html>
